{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Admin/Downloads/mern-amazona-master/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Admin/Downloads/mern-amazona-master/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Admin/Downloads/mern-amazona-master/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import axios from'axios';import React,{useContext,useEffect,useRef,useState}from'react';import{LoadScript,GoogleMap,StandaloneSearchBox,Marker}from'@react-google-maps/api';import{useNavigate}from'react-router-dom';import{Store}from'../Store';import Button from'react-bootstrap/Button';import{toast}from'react-toastify';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var defaultLocation={lat:45.516,lng:-73.56};var libs=['places'];export default function MapScreen(){var _useContext=useContext(Store),state=_useContext.state,ctxDispatch=_useContext.dispatch;var userInfo=state.userInfo;var navigate=useNavigate();var _useState=useState(''),_useState2=_slicedToArray(_useState,2),googleApiKey=_useState2[0],setGoogleApiKey=_useState2[1];var _useState3=useState(defaultLocation),_useState4=_slicedToArray(_useState3,2),center=_useState4[0],setCenter=_useState4[1];var _useState5=useState(center),_useState6=_slicedToArray(_useState5,2),location=_useState6[0],setLocation=_useState6[1];var mapRef=useRef(null);var placeRef=useRef(null);var markerRef=useRef(null);var getUserCurrentLocation=function getUserCurrentLocation(){if(!navigator.geolocation){alert('Geolocation os not supported by this browser');}else{navigator.geolocation.getCurrentPosition(function(position){setCenter({lat:position.coords.latitude,lng:position.coords.longitude});setLocation({lat:position.coords.latitude,lng:position.coords.longitude});});}};useEffect(function(){var fetch=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _yield$axios,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return axios('/api/keys/google',{headers:{Authorization:\"BEARER \".concat(userInfo.token)}});case 2:_yield$axios=_context.sent;data=_yield$axios.data;setGoogleApiKey(data.key);getUserCurrentLocation();case 6:case\"end\":return _context.stop();}},_callee);}));return function fetch(){return _ref.apply(this,arguments);};}();fetch();ctxDispatch({type:'SET_FULLBOX_ON'});},[ctxDispatch]);var onLoad=function onLoad(map){mapRef.current=map;};var onIdle=function onIdle(){setLocation({lat:mapRef.current.center.lat(),lng:mapRef.current.center.lng()});};var onLoadPlaces=function onLoadPlaces(place){placeRef.current=place;};var onPlacesChanged=function onPlacesChanged(){var place=placeRef.current.getPlaces()[0].geometry.location;setCenter({lat:place.lat(),lng:place.lng()});setLocation({lat:place.lat(),lng:place.lng()});};var onMarkerLoad=function onMarkerLoad(marker){markerRef.current=marker;};var onConfirm=function onConfirm(){var places=placeRef.current.getPlaces()||[{}];ctxDispatch({type:'SAVE_SHIPPING_ADDRESS_MAP_LOCATION',payload:{lat:location.lat,lng:location.lng,address:places[0].formatted_address,name:places[0].name,vicinity:places[0].vicinity,googleAddressId:places[0].id}});toast.success('location selected successfully.');navigate('/shipping');};return/*#__PURE__*/_jsx(\"div\",{className:\"full-box\",children:/*#__PURE__*/_jsx(LoadScript,{libraries:libs,googleMapsApiKey:googleApiKey,children:/*#__PURE__*/_jsxs(GoogleMap,{id:\"smaple-map\",mapContainerStyle:{height:'100%',width:'100%'},center:center,zoom:15,onLoad:onLoad,onIdle:onIdle,children:[/*#__PURE__*/_jsx(StandaloneSearchBox,{onLoad:onLoadPlaces,onPlacesChanged:onPlacesChanged,children:/*#__PURE__*/_jsxs(\"div\",{className:\"map-input-box\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Enter your address\"}),/*#__PURE__*/_jsx(Button,{type:\"button\",onClick:onConfirm,children:\"Confirm\"})]})}),/*#__PURE__*/_jsx(Marker,{position:location,onLoad:onMarkerLoad})]})})});}","map":{"version":3,"names":["axios","React","useContext","useEffect","useRef","useState","LoadScript","GoogleMap","StandaloneSearchBox","Marker","useNavigate","Store","Button","toast","defaultLocation","lat","lng","libs","MapScreen","state","ctxDispatch","dispatch","userInfo","navigate","googleApiKey","setGoogleApiKey","center","setCenter","location","setLocation","mapRef","placeRef","markerRef","getUserCurrentLocation","navigator","geolocation","alert","getCurrentPosition","position","coords","latitude","longitude","fetch","headers","Authorization","token","data","key","type","onLoad","map","current","onIdle","onLoadPlaces","place","onPlacesChanged","getPlaces","geometry","onMarkerLoad","marker","onConfirm","places","payload","address","formatted_address","name","vicinity","googleAddressId","id","success","height","width"],"sources":["C:/Users/Admin/Downloads/mern-amazona-master/frontend/src/screens/MapScreen.js"],"sourcesContent":["import axios from 'axios';\nimport React, { useContext, useEffect, useRef, useState } from 'react';\nimport {\n  LoadScript,\n  GoogleMap,\n  StandaloneSearchBox,\n  Marker,\n} from '@react-google-maps/api';\nimport { useNavigate } from 'react-router-dom';\nimport { Store } from '../Store';\nimport Button from 'react-bootstrap/Button';\nimport { toast } from 'react-toastify';\n\nconst defaultLocation = { lat: 45.516, lng: -73.56 };\nconst libs = ['places'];\n\nexport default function MapScreen() {\n  const { state, dispatch: ctxDispatch } = useContext(Store);\n  const { userInfo } = state;\n  const navigate = useNavigate();\n  const [googleApiKey, setGoogleApiKey] = useState('');\n  const [center, setCenter] = useState(defaultLocation);\n  const [location, setLocation] = useState(center);\n\n  const mapRef = useRef(null);\n  const placeRef = useRef(null);\n  const markerRef = useRef(null);\n\n  const getUserCurrentLocation = () => {\n    if (!navigator.geolocation) {\n      alert('Geolocation os not supported by this browser');\n    } else {\n      navigator.geolocation.getCurrentPosition((position) => {\n        setCenter({\n          lat: position.coords.latitude,\n          lng: position.coords.longitude,\n        });\n        setLocation({\n          lat: position.coords.latitude,\n          lng: position.coords.longitude,\n        });\n      });\n    }\n  };\n  useEffect(() => {\n    const fetch = async () => {\n      const { data } = await axios('/api/keys/google', {\n        headers: { Authorization: `BEARER ${userInfo.token}` },\n      });\n      setGoogleApiKey(data.key);\n      getUserCurrentLocation();\n    };\n\n    fetch();\n    ctxDispatch({\n      type: 'SET_FULLBOX_ON',\n    });\n  }, [ctxDispatch]);\n\n  const onLoad = (map) => {\n    mapRef.current = map;\n  };\n  const onIdle = () => {\n    setLocation({\n      lat: mapRef.current.center.lat(),\n      lng: mapRef.current.center.lng(),\n    });\n  };\n\n  const onLoadPlaces = (place) => {\n    placeRef.current = place;\n  };\n  const onPlacesChanged = () => {\n    const place = placeRef.current.getPlaces()[0].geometry.location;\n    setCenter({ lat: place.lat(), lng: place.lng() });\n    setLocation({ lat: place.lat(), lng: place.lng() });\n  };\n\n  const onMarkerLoad = (marker) => {\n    markerRef.current = marker;\n  };\n\n  const onConfirm = () => {\n    const places = placeRef.current.getPlaces() || [{}];\n    ctxDispatch({\n      type: 'SAVE_SHIPPING_ADDRESS_MAP_LOCATION',\n      payload: {\n        lat: location.lat,\n        lng: location.lng,\n        address: places[0].formatted_address,\n        name: places[0].name,\n        vicinity: places[0].vicinity,\n        googleAddressId: places[0].id,\n      },\n    });\n    toast.success('location selected successfully.');\n    navigate('/shipping');\n  };\n  return (\n    <div className=\"full-box\">\n      <LoadScript libraries={libs} googleMapsApiKey={googleApiKey}>\n        <GoogleMap\n          id=\"smaple-map\"\n          mapContainerStyle={{ height: '100%', width: '100%' }}\n          center={center}\n          zoom={15}\n          onLoad={onLoad}\n          onIdle={onIdle}\n        >\n          <StandaloneSearchBox\n            onLoad={onLoadPlaces}\n            onPlacesChanged={onPlacesChanged}\n          >\n            <div className=\"map-input-box\">\n              <input type=\"text\" placeholder=\"Enter your address\"></input>\n              <Button type=\"button\" onClick={onConfirm}>\n                Confirm\n              </Button>\n            </div>\n          </StandaloneSearchBox>\n          <Marker position={location} onLoad={onMarkerLoad}></Marker>\n        </GoogleMap>\n      </LoadScript>\n    </div>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}